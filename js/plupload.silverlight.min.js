(function(b){var a={};function c(n){var p=false;var d=null;try{var j=null;try{j=new ActiveXObject("AgControl.AgControl");if(n==null){p=true}else{if(j.IsVersionSupported(n)){p=true}}j=null}catch(m){var k=navigator.plugins["Silverlight Plug-In"];if(k){if(n===null){p=true}else{var f=k.description;if(f==="1.0.30226.2"){f="2.0.30226.2"}var g=f.split(".");while(g.length>3){g.pop()}while(g.length<4){g.push(0)}var h=n.split(".");while(h.length>4){h.pop()}var o,i,l=0;do{o=parseInt(h[l]);i=parseInt(g[l]);l++}while(l<h.length&&o===i);if(o<=i&&!isNaN(o)){p=true}}}}}catch(m){p=false}return p}b.silverlight={trigger:function(h,e){var g=a[h],f,d;if(g){d=b.toArray(arguments).slice(1);d[0]="Silverlight:"+e;setTimeout(function(){g.trigger.apply(g,d)},0)}}};b.SilverlightRuntime=b.addRuntime("silverlight",{init:function(j,k){var h,f="",g=j.settings.filters,e;if(!c("2.0.31005.0")){k({success:false});return}a[j.id]=j;h=document.createElement("div");h.id=j.id+"_silverlight_container";b.extend(h.style,{position:"absolute",top:"0",background:j.settings.silverlight_bgcolor||"transparent",width:"100px",height:"100px",opacity:0.01});h.className="plupload_silverlight";document.body.appendChild(h);for(e=0;e<g.length;e++){f+=(f!=""?"|":"")+g[e].title+" | *."+g[e].extensions.replace(/,/g,";*.")}h.innerHTML='<object id="'+j.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%"><param name="source" value="'+j.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="initParams" value="id='+j.id+",filter="+f+'"/><param name="onerror" value="onSilverlightError" /></object>';function d(){return document.getElementById(j.id+"_silverlight").content.Upload}j.bind("Silverlight:Init",function(){var i,l={};j.bind("Silverlight:StartSelectFiles",function(m){i=[]});j.bind("Silverlight:SelectFile",function(m,p,n,o){var q;q=b.guid();l[q]=p;l[p]=q;i.push(new b.File(q,n,o))});j.bind("Silverlight:SelectSuccessful",function(){j.trigger("FilesSelected",i)});j.bind("Silverlight:UploadFileProgress",function(m,q,n,p){var o=m.getFile(l[q]);o.size=p;o.loaded=n;m.trigger("UploadProgress",o)});j.bind("Refresh",function(m){var n,o;n=document.getElementById(m.settings.browse_button);o=b.getPos(n);b.extend(document.getElementById(m.id+"_silverlight_container").style,{top:o.y+"px",left:o.x+"px",width:n.clientWidth+"px",height:n.clientHeight+"px"})});j.bind("Silverlight:UploadChunkSuccessful",function(m,p,n,s,r){var q,o=m.getFile(l[p]);q={file:o,chunk:n,chunks:s,response:r};m.trigger("ChunkUploaded",q);if(q.cancelled){d().CancelUpload();o.status=b.FAILED;m.trigger("FileUploaded",o);return}});j.bind("Silverlight:UploadSuccessful",function(m,o){var n=m.getFile(l[o]);n.status=b.DONE;m.trigger("FileUploaded",n)});j.bind("FileRemoved",function(m,n){d().RemoveFile(l[n.id])});j.bind("UploadFile",function(m,o){var n=m.settings.url;n+=(n.indexOf("?")==-1?"?":"&")+"name="+escape(o.target_name||o.name);d().UploadFile(l[o.id],n,m.settings.chunk_size,m.settings.image_width,m.settings.image_height,m.settings.image_quality)});k({success:true})})}})})(plupload);